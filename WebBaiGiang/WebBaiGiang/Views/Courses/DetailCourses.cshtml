@using WebBaiGiang.ViewModel
@model LopHocViewModel

@{
    if (User.IsInRole("Student"))
    {
        Layout = "~/Views/Shared/_LayoutSinhvien.cshtml";
    }
    else if (User.IsInRole("Teacher"))
    {
        Layout = "~/Views/Shared/_LayoutGiangvien.cshtml";
    }
}


<div class="conTent">
    <h3>Khoá học > @Model.Name</h3>
</div>

<style>
    .conTent h3 {
        margin-left: 70px;
        margin-top: 10px;
        font-family: Arial, sans-serif;
        font-weight: 700;
        font-size: 30px;
    }

    .custom-tabs {
        display: flex;
        gap: 10px;
        margin-top: 30px;
        margin-left: 60px;
    }

    .tab-button {
        padding: 10px 20px;
        background-color: #e0e0e0;
        border: none;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

        .tab-button.active {
            background-color: #1a73e8;
            color: white;
        }

    .tab-section {
        display: none;
        margin-left: 60px;
    }

        .tab-section.active {
            display: block;
        }

    .header-banner {
        background-color: #1a73e8;
        color: white;
        padding: 2rem;
        border-radius: 8px;
        background-size: cover;
        background-position: center;
        min-height: 200px;
        display: flex;
        align-items: flex-end;
        max-width: 90%;
        margin: 20px auto;
    }

    .class-title {
        font-size: 30px;
        font-weight: 700;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }

    .dropdown {
        position: relative;
        display: inline-block;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        right: 0;
        background-color: #f1f1f1;
        min-width: 150px;
        box-shadow: 0px 8px 16px rgba(0,0,0,0.2);
        z-index: 1;
        border-radius: 6px;
        overflow: hidden;
    }

        .dropdown-content a, .dropdown-content button {
            padding: 10px;
            display: block;
            text-decoration: none;
            color: #333;
            background: none;
            border: none;
            text-align: left;
            width: 100%;
            cursor: pointer;
        }

            .dropdown-content a:hover,
            .dropdown-content button:hover {
                background-color: #ddd;
            }

    .dropdown:hover .dropdown-content {
        display: block;
    }

    .icon-three-dots::before {
        content: "⋮";
        font-size: 20px;
        cursor: pointer;
    }

    .post-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #ccc;
        padding: 12px 0;
        max-width: 90%;
    }

    .post-left {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .icon-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #28a745;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
    }

    .text-muted {
        font-size: 14px;
        color: #666;
    }

    .pagination {
        list-style: none;
        padding: 0;
        display: flex;
        gap: 5px;
        justify-content: center;
        margin-top: 20px;
    }

        .pagination li {
            display: inline;
        }

        .pagination a,
        .pagination span {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 4px;
            background-color: #eee;
            color: black;
            text-decoration: none;
        }

        .pagination .active span {
            background-color: #1a73e8;
            color: white;
            font-weight: bold;
        }
</style>

<!-- Tabs -->
<div class="custom-tabs">
    <button class="tab-button active" data-tab="contentTab">Nội dung</button>
    <button class="tab-button" data-tab="exerciseTab">Bài tập trên lớp</button>
    <button class="tab-button" data-tab="peopleTab">Mọi người</button>
    <button class="tab-button" data-tab="gradeTab">Điểm</button>
</div>

<!-- Banner -->
<div class="header-banner" style="background-image: url('@Model.Picture');">
    <h3 class="class-title text-white">@Model.Name</h3>
</div>

<!-- Tab: Mọi người -->
<div id="peopleTab" class="tab-section">
    @Html.Partial("_ThemNguoiPartial", new InviteStudentViewModel { ClassId = Model.Id })
</div>

<!-- Tab: Điểm -->
<div id="gradeTab" class="tab-section">
    <p>Điểm số sẽ hiển thị ở đây</p>
</div>

<!-- Tab: Bài tập -->
<div id="exerciseTab" class="tab-section">
    @Html.Partial("BaiTap", Model.BaiTaps)
</div>

<!-- Tab: Nội dung (Bài giảng) -->
<div id="contentTab" class="tab-section active">
    @Html.Partial("~/Views/GiangVien/BaiGiang.cshtml", Model.BaiGiangs)
@*     <!-- PHÂN TRANG -->
    @if (Model.BaiGiangs != null && Model.BaiGiangs.TotalPages > 1)
    {
        <ul class="pagination">
            @if (Model.BaiGiangs.HasPreviousPage)
            {
                <li>
                    <a href="@Url.Action("DetailCourses", new { id = Model.Id, page = Model.BaiGiangs.PageIndex - 1 })">← Trước</a>
                </li>
            }

            @for (int i = 1; i <= Model.BaiGiangs.TotalPages; i++)
            {
                if (i == Model.BaiGiangs.PageIndex)
                {
                    <li class="active"><span>@i</span></li>
                }
                else
                {
                    <li>
                        <a href="@Url.Action("DetailCourses", new { id = Model.Id, page = i })">@i</a>
                    </li>
                }
            }

            @if (Model.BaiGiangs.HasNextPage)
            {
                <li>
                    <a href="@Url.Action("DetailCourses", new { id = Model.Id, page = Model.BaiGiangs.PageIndex + 1 })">Sau →</a>
                </li>
            }
        </ul>
    }
</div> *@

<!-- JS Tab handling -->
<script>
    document.querySelectorAll(".tab-button").forEach(button => {
        button.addEventListener("click", function () {
            document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
            this.classList.add("active");

            document.querySelectorAll(".tab-section").forEach(section => section.classList.remove("active"));
            const tabId = this.getAttribute("data-tab");
            document.getElementById(tabId).classList.add("active");
        });
    });

    document.addEventListener("DOMContentLoaded", function () {
        const hash = window.location.hash;
        if (hash) {
            const tab = document.querySelector(`.tab-button[data-tab="${hash.substring(1)}"]`);
            if (tab) tab.click();
        }
    });
</script>
